\documentclass[zavrsnirad]{fer}
% Dodaj opciju upload za generiranje konačne verzije koja se učitava na FERWeb
% Add the option upload to generate the final version which is uploaded to FERWeb


\usepackage{blindtext}


%--- PODACI O RADU / THESIS INFORMATION ----------------------------------------

% Naslov na engleskom jeziku / Title in English
\title{Development of an agent for solving the Entaglement game}

% Naslov na hrvatskom jeziku / Title in Croatian
\naslov{Razvoj agenta za igranje igre Entanglement}

% Broj rada / Thesis number
\brojrada{1}

% Autor / Author
\author{Iva Rengel}

% Mentor 
\mentor{Prof.\@ Marko Đurasević}

% Datum rada na engleskom jeziku / Date in English
\date{June, 2024}

% Datum rada na hrvatskom jeziku / Date in Croatian
\datum{lipanj, 2024.}

%-------------------------------------------------------------------------------


\begin{document}


% Naslovnica se automatski generira / Titlepage is automatically generated
\maketitle


%--- ZADATAK / THESIS ASSIGNMENT -----------------------------------------------

% Zadatak se ubacuje iz vanjske datoteke / Thesis assignment is included from external file
% Upiši ime PDF datoteke preuzete s FERWeb-a / Enter the filename of the PDF downloaded from FERWeb
\zadatak{filename.pdf}


%--- ZAHVALE / ACKNOWLEDGMENT --------------------------------------------------

\begin{zahvale}
  % Ovdje upišite zahvale / Write in the acknowledgment
  Hvala na kavi...
\end{zahvale}


% Odovud započinje numeriranje stranica / Page numbering starts from here
\mainmatter


% Sadržaj se automatski generira / Table of contents is automatically generated
\tableofcontents


%--- UVOD / INTRODUCTION -------------------------------------------------------
\chapter{Uvod}
\label{pog:uvod}

Neki od radova koje ćemo citirati su \cite{6248073,6247753,ghiglia_pritt_phase_unwrapping,hartley2003multiple,4250461,123DCatch}.
Trebaju nam samo radi testiranja kako izgleda referenciranje rada s konferencije, rada iz časopisa, knjige i Internetske stranice.

\begin{figure}[htb]
  \centering
  \includegraphics[width=0.38\linewidth]{Figures/lenovo_yoga_tab3_pro_front.png} 
  \caption{Moja prva slika}
  \label{slk:prvaslika}
\end{figure}

Referenciramo se na sliku \ref{slk:prvaslika} u sredini rečenice, zatim prije zareza \ref{slk:prvaslika}, te zatim na kraju rečenice \ref{slk:prvaslika}.
Upravo smo testirali radi li naredba \verb|\ref| ispravno u slučaju kada nakon nje slijedi točka.

Sada slijedi jedna jednadžba:
\begin{equation}
  \label{jed:prvajednadzba}
  \int_{-\infty}^{+\infty}f(t)\,dt=F(\omega)
\end{equation}
Jednadžba \eqref{jed:prvajednadzba} je moja prva jednadžba koja defnira par $f(t)\ufrek F(\omega)$ ili $F(\omega)\uvrem f(t)$.

Opis zadatka gdje ce se pojaviti ovaj tekst? Neznam dok ne convertam opet PDF? Tocno.
Okay, krenimo s pisanjem zavrsnog.

Poručiti pravila igranje igre Entaglement. Razviti jednostavno programsko okruženje koje omogućuje testiranje različitih agenata za igranje navedene igre. Razviti jednostavne heuristike za igranje navedene igre. Proučiti literaturu koja se bavi razvojem agenata za slične probleme igranje igara. Predložiti i razviti agenta za igranje igre Entanglement koji je temeljen na metodama optimizacije ili neuronskih mreža. Ispitati učinkovitost razvijenog agenta te ju usporediti s rezultatima ostvarenim jednostanim heuristikama. Radu priložiti izvorne tekstove programa, dobivene rezultate uz potrebna objašnjenja i korištenu literaturu.

Plan rada:
Za vrijeme pisanja ovog dijela trenutno je 5ti tjedan nastave.
Planirana poglavlja dokumentacije:
- opis igre entanglement
- opis pronadene i modificirane igre u koju se moze ubaciti agent
- razvijanje i isprobavanje heuristika
- razviti agente s neuronskim mrezama
- razviti agente koristenjem metoda optimizacija
- usporedba rezultata
- opt: upogonjenje heuristika u kombo s neuronskom mrezom

Zadatci:
- pokusat upogonit onay python package za crtanje grafova radi mogucnosti vizualiyacije rezultata
- prouciti literaturu i napisati sazetke o navedenim temama iznad



%-------------------------------------------------------------------------------
\chapter{Glavni dio}
\label{pog:glavni_dio}

\section{O igri Entanglement}
\label{pog:o_igri}


Igra Entanglement jest online igra koju su napravili \cite{gopherwoodstudios} Gopherwood Studios. Igra se sastoji od velike igrače ploče s heksagonalnim izrezima u koje se postavljaju pločice. Igra kreče od središnje, već postavljene pločice. Na njoj je vidljiv "konac" izrazite boje, ovdje je crven te će u kasnijim primjerima biti žarko zelen.

\begin{figure}[htb]
	\centering
	\includegraphics[width=0.58\linewidth]{Figures/game.png} 
	\caption{Prikaz originalne igre u tijeku}
	\label{slk:game_screen}
\end{figure}

Jedan potez igre jest jedno postavljanje nove pločice. Sve pločice na sebi imaju 12 smjerova, spojenih međusobno u šest nasumično izabranih puteva. Prije no što se pločica postavi na ploču, moguće ju je rotirati ili zamijeniti sa zamjenskom pločicom. Nakon postavljanja, iz onog smjera iz kojeg dolazi konac iz prijašnje ploče, put koji počinje tim smjerom bit će osvijetljen bojom. Igra se nastavlja davanjem igraču novogeneriranu pločicu koje sada može postaviti na polje gdje put konca završava.

Ako put konca ne završi u praznom polju, već u startnom polju ili na granici, igra završava. Ako put konca završava tamo gdje se nalazi već postavljena igračeva pločica, za svaku naknadnu pločicu koju konac prođe do sljedećeg praznog mjesta ili granice dodaje se linearno rastući broj bodova na vrijednost ukupnih bodova. Na primjer, ako se konac pronađe u praznom polju odmah nakon postavljanja ploče, igrač dobiva samo 1 bod. Ali ako se kraj konca pronađe na ulazu u neku drugu ploču te sveukupno prolazi kroz 4 pločice dok ne dođe do praznog polja, na kraju prolaska na vrijednost ukupnih bodova akumulirat će se cijena 1 + 2 + 3 + 4 = 10 bodova.

Jednom kada se trenutna pločica zamjeni sa zamjenskom, tamo će ostati do sljedeće zamjene. Cilj igre jest skupiti što je moguće više bodova prije no što se popune sve prazne pločice ili se konac "zabije" u neku od granica. U oba slučaja, krajnji bodovi isti su sveukupnim do tada akumuliranim bodovima kroz igru. Trenutno najveći broj bodova ikad sakupljen jest 5403.

\section{Definicija heuristika i neuronskih mreža}
\label{pog:opis_heuristika_i_neuronskih}


Heuristika ili heuristička tehnika u pogledu programiranja predstavlja korištenje neke metode ili algoritma za izračun koliko je dobro koje stanje igre, te nam tako pomaže kod odabira najboljeg poteza. Ta metoda ili algoritam ne mora u svakom slučaju dati najbolji rezultat, te njen izračun ne mora imati nužno logičko objašnjenje zašto se koristi. Dovoljno je samo da nam ubrzala proces traženja sljedećih poteza ili pridonosi većem ukupnom broju bodova na kraju igre.

U pogledu na promatranu igru entanglement lako se mogu odrediti svojstva poteza o kojima ovisi rezultat igre, te ću na temelju na njima izgraditi neke heuristike. Takva promatrana svojstva su nalazi li se zid na nekom od mogućih puteva pločice koju trenutno postavljamo, koliki dug lanac dobijemo na nekom putu, te kolika je popunjenost ploče. 


-- TODO objasnjenje neuronskih



\section{Razvojno okruženje za implementaciju heuristika i agenata}
\label{pog:razvojno_okruzenje}


Sljedeći korak na mom putu bio je pronalazak verzije igre čiji kod mogu mijenjati po želji. Naime, kod originalne online verzije igre jest skriven i na njega se ne može jednostavno priključiti. Kako bih uspjela u implementaciji različitih heuristika i agenata i vidjela kako utječu na igru, potreban mi je izvorni kod igre s istim pravilima. Takav je pronađen u GitHub repozitoriju \cite{entanglementgithub} entanglement osobe Brian Shaginaw.

Ovaj repozitorij pisan je u Pythonu 2, pa je prva stvar kod spajanja na izvorni kod bila mijenjanje i prilagođavanje koda da radi s Pythonom verzije 3. Ovaj korak izveden je relativno brzo, te je sljedeći dio zauzeo puno više vremena, a to je proučavanje i pokušavanje spajanja na kod te istraživanje što su to heuristike i kako ih uspješno implementirati. 

\begin{figure}[htb]
	\centering
	\includegraphics[width=0.58\linewidth]{Figures/gamefinished.png} 
	\caption{Prikaz preuzete igre}
	\label{slk:game_finished}
\end{figure}

U kod je bilo potrebno dodati neke nove funkcije. Radi preglednosti i otkrivanja pogrešaka, implementirane su funkcionalnosti pauziranja i izlaska iz programa. Dodana je metoda resetiranja igre, kako bi se, nakon zabijanja konca u zid, umjesto da program završi s radom umjesto toga obrisala ploča, spremili rezultati te započela nova runda igre. Također, dodana je metoda koja na temelju ulaza obavlja jedan korak igre (postavljanje pločice.)



\section{Definicija stanja igre, ploče, opasnosti i koraka}
\label{pog:definicija_stanja}

Kako bismo mogli birati optimalne korake od onih mogućih, nekako moramo definirati koliko nam je svaki korak vrijedan. Vrijednost koraka ovisit će o trenutnom stanju igre. Naime, pločica se ne nalazi u istoj situaciji ako je okružena praznim poljima, ili ako je samo jedno neposredno mjesto uz nju prazno. Zato moramo prikupiti informacije iz izgleda same ploče u neku strukturu koju će nam biti lakše obraditi.

Stanje igre temeljit ćemo na već postojećim tipu podataka u kodu nazvanoj Board, što je klasa koja predstavlja igraću ploču (Slika \ref{slk:class_diagram}).

\begin{figure}[htb]
	\centering
	\includegraphics[width=0.68\linewidth]{Figures/board_diagram.png} 
	\caption{Dijagram razreda Board i Tile}
	\label{slk:class_diagram}
\end{figure}

Unutar te klase imamo mnoštvo atributa:
\begin{itemize}
	\item[board] lista svih pločica, te svaka od njih pamti svoju vrstu (otvorena, zatvorena, start-pločica ili igraća), te ako je igraća, izgled svojih konaca i par osvijetljenih konaca.
	\item[entry] iz kojeg od 12 smjerova na pločicu koja se trenutno postavlja dolazi osvijetljeni konac
	\item[x i y] koordinate pločice koja se trenutno postavlja
	\item[curr tile] trenutna pločica
	\item[swap tile] zamjenska pločica
	\item[score] do sad skupljeni broj bodova
	\item[dirty] je li igra započeta, je li ikoja pločica postavljena na ploču
\end{itemize}

Stanje igre jest dugo polje cjelobrojnih varijabli izračunatih uz pomoć ploče igre. Za svaki od 12 smjerova one pločice na koje trenutne koordinate pokazuju, izračunava se duljina puta do sljedećeg praznog mjesta (0 ako je to mjesto odmah susjedno trenutnim koordinatama, 1 ili više ako prvo vodi kroz već postavljene ploče prije praznog mjesta), je li taj smjer opasan ili ne, koje su koordinate praznog polja na kojem će završiti, koji su smjerovi već izgeneriranih trenutne i zamjenske pločice. Različito stanje igre jest potrebno za različite heuristike, te će kasnije kod opisa svake biti objašnjena i struktura polja stanja igre.

Opasnost definiramo kao onaj potez koji dovodi do kraja igre. Od četiri moguća tipa pločica, zatvorena i start-pločica su opasne i kad vrh konca dođe do njih igra završava. Ako bi potez vodio konac na neki smjer koji pokazuje na igraću pločicu, potrebno je rekurzivnim algoritmom odrediti u kojem tipu pločice se nalazi njegov završetak. Tada možemo odrediti je li taj smjer opasan ili ne.

Jedan korak, ili jedan potez, sastoji se od postavljanjem ili nepostavljanjem zastavice za mijenjanje trenutne pločice sa zamjenskom, te rotiranja izabrane u smjeru kazaljke na satu za neki cjelobrojni broj od 0 do 5.


\section{Biranje koraka slučajnim odabirom}
\label{pog:slucajan_odabir}

Kako bismo imali nešto s čime dalje možemo uspoređivati efektivnost koje heuristike pogledat ćemo što se događa s igrom ako joj prepustimo odabir svakog sljedećeg koraka slučajnom odabiru. Nakon 100 koraka igre, vidljivo je da se rezultat kreće oko 9 bodova na grafu priloženom na slici \ref{slk:random_graph}.


\begin{figure}[htb]
	\centering
	\includegraphics[width=0.68\linewidth]{Figures/random.png} 
	\caption{Graf slučajnog odabira poteza nakon 100 instanci igre}
	\label{slk:random_graph}
\end{figure}

\section{Implementirane heuristike}
\label{pog:heuristics}

\subsection{Neposredna heuristika}
\label{pog:neposredna}

Prva heuristika koju promatramo stanje igre izračunava kao polje od svega šest cjelobrojnih vrijednosti. Svaka varijabla poprima vrijednost 0 ili 1, gdje nula označava da je taj smjer neposredno siguran, te jedinica označava da nije. Ako se neposredno od trenutne pločice pojavi već postavljena pločica, heuristika je smatra sigurnom. Zbog toga program u često mnogo slučajeva završi prije nego što popuni cijelu ploču.

Igra računa sljedeći potez tako da slučajnim odabirom izabere za koliko će se rotirati trenutna pločica, te provjeri je ti takav potez opasan. Ako je, izračunava se novi potez, te ako su svi potezi nesigurni, mijenja se trenutna pločica sa zamjenskom. Ovakva heuristika pridonosi rezultatu od prosječno 25 bodova, vidljivo na slici \ref{slk:sofort_graph}

\begin{figure}[htb]
	\centering
	\includegraphics[width=0.68\linewidth]{Figures/sofort.png} 
	\caption{Graf neposredne heuristike nakon 100 instanci igre}
	\label{slk:sofort_graph}
\end{figure}


\subsection{Dubinska heuristika sa slučajnim odabirom}
\label{pog:dubinska_slucajna}

S ovom heuristikom proširujem stanje igre na izračunavanje vode li i već postavljene igraće ploče u opasnost. Odabir poteza radi na isti način kao i u prijašnjem orimjeru, te se sad prosječan broj bodova podigao na čak 75 te se ploča u većini slučajeva popuni barem 80 posto [Slika \ref{slk:reach_graph}].

\begin{figure}[htb]
	\centering
	\includegraphics[width=0.68\linewidth]{Figures/reach.png} 
	\caption{Graf dubinske heuristike (slučajne) nakon 100 instanci igre}
	\label{slk:reach_graph}
\end{figure}


\subsection{Dubinska heuristika sa izračunavanjem najduljeg puta}
\label{pog:dubinska}

Umjesto da bira potez slučajnim odabirom, ova heuristika prolazi kroz sve puteve koje je moguće doseći sa trenutnom i zamjenskom pločicom te od njih uzima onaj koji pridonosi najviše bodova instanci igre. Prosjek sakupljenih upupnih bodova sada je 91 [Slika \ref{slk:depth_graph}].

\begin{figure}[htb]
	\centering
	\includegraphics[width=0.68\linewidth]{Figures/depth.png} 
	\caption{Graf dubinske heuristike nakon 100 instanci igre}
	\label{slk:depth_graph}
\end{figure}


%-------------------------------------------------------------------------------
\chapter{Rezultati i rasprava}
\label{pog:rezultati_i_rasprava}

\Blindtext


%--- ZAKLJUČAK / CONCLUSION ----------------------------------------------------
\chapter{Zaključak}
\label{pog:zakljucak}

\blindtext


%--- LITERATURA / REFERENCES ---------------------------------------------------

% Literatura se automatski generira iz zadane .bib datoteke / References are automatically generated from the supplied .bib file
% Upiši ime BibTeX datoteke bez .bib nastavka / Enter the name of the BibTeX file without .bib extension
\bibliography{literatura}



%--- SAŽETAK / ABSTRACT --------------------------------------------------------

% Sažetak na hrvatskom
\begin{sazetak}
  Unesite sažetak na hrvatskom.

  \blindtext
\end{sazetak}

\begin{kljucnerijeci}
  prva ključna riječ; druga ključna riječ; treća ključna riječ
\end{kljucnerijeci}


% Abstract in English
\begin{abstract}
  Enter the abstract in English.
  
  \blindtext 
\end{abstract}

\begin{keywords}
  the first keyword; the second keyword; the third keyword
\end{keywords}


%--- PRIVITCI / APPENDIX -------------------------------------------------------

% Sva poglavlja koja slijede će biti označena slovom i riječi privitak / All following chapters will be denoted with an appendix and a letter
\backmatter

\chapter{The Code}

\Blindtext


\end{document}
